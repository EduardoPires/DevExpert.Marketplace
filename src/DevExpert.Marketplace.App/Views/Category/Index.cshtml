@model List<DevExpert.Marketplace.Application.ViewModels.OutputViewModels.CategoryOutputViewModel>

@{
    ViewData["Title"] = "Categorias";
}

<div class="container py-5">
    <!-- Cabeçalho com título e opção de incluir nova categoria -->
    <div class="header-section">
        <h1>Lista de Categorias</h1>
        <div>
            <a class="new-category-link me-3" title="Nova Categoria" asp-action="Create">
                <i class="bi bi-plus-circle"></i> Nova Categoria
            </a>
        </div>
    </div>

    <!-- Lista de Categorias -->
    <ul class="list-group">

        @foreach (var category in Model)
        {
            <li class="list-group-item">
                <span>@category.Name</span>
                <div>
                    <a class="btn-icon me-2 d-inline-flex align-items-center" title="Editar" asp-action="Edit"
                       asp-route-id="@category.Id">
                        <i class="bi bi-pencil"></i>
                    </a>

                    <button type="button" class="btn-icon-trash" title="Excluir" data-bs-toggle="modal"
                            data-bs-target="#deleteModal" data-category-id="@category.Id">
                        <i class="bi bi-trash"></i>
                    </button>
                </div>
            </li>
        }
    </ul>
</div>

<!-- Delete Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4">
            <div class="modal-body text-center">
                <!-- Ícone de Lixeira -->
                <div class="p-4 mb-3"
                     style="background-color: #FFE8E8;
                                  border-radius: 50%;
                                  width: 80px;
                                  height: 80px;
                                  margin: 0 auto;
                                  display: flex;
                                  justify-content: center;
                                  align-items: center;">
                    <i class="bi bi-trash" style="font-size: 2.5rem; color: #E74C3C;"></i>
                </div>


                <!-- Mensagem Principal -->
                <h5 class="fw-bold">Tem certeza que deseja excluir esta categoria?</h5>
                <p class="text-muted">Esta categoria será excluída permanentemente.</p>

                <!-- Botões de Ação -->
                <div class="d-flex justify-content-around mt-4">
                    <button type="button" class="btn btn-outline-secondary px-4 py-2 rounded-3" data-bs-dismiss="modal">
                        Cancelar
                    </button>
                    <form id="deleteForm" method="post">
                        <button type="submit" class="btn btn-danger px-4 py-2 rounded-3">Sim, Excluir</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Script para passar o ID dinamicamente para o formulário -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        var deleteModal = document.getElementById('deleteModal');
        deleteModal.addEventListener('show.bs.modal', function (event) {
            var button = event.relatedTarget;
            var categoryId = button.getAttribute('data-category-id');

            var form = document.getElementById('deleteForm');
            form.setAttribute('action', `/excluir-categoria/${categoryId}`);
            form.setAttribute('method', 'post');

            var methodInput = document.createElement('input');
            methodInput.setAttribute('type', 'hidden');
            methodInput.setAttribute('name', '_method');
            methodInput.setAttribute('value', 'DELETE');

            form.appendChild(methodInput);
        });
    });

</script>

<!-- Bootstrap 5 JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>